---
layout: post
title:  Laboratório 3 - Parte 1
date: "2017-05-15 16:03:30"
published: true
tags: [example1, example2]
---




Este documento é referente a Parte 1 do Lab 3, aqui estaremos fazendo uma análise descritiva para o entendimento dos dados. A base de dados que iremos utilizar é referente aos anos de 2000 a 2015 e mostra a frequência de evasão de alunos de Ciência da Computação ao fim do primeiro semestre de aula no curso durante esse período de tempo. Teremos as seguintes colunas em nossa base de dados com seus respectivos significados:

* **MAT_ALU_MATRICULA**: Matrícula aluno (anonimizado)
* **MAT_TUR_DIS_DISCIPLINA**: Código Disciplina
* **disciplina**: Nome Disciplina
* **MAT_TUR_ANO**: Ano da matrícula
* **MAT_MEDIA_FINAL**: Média obtida na disciplina
* **EVADIU**: Variável-alvo que indica se o aluno evadiu ou não ao término do período.


{% highlight r %}
dados = read.csv("treino_classificacao.csv")
{% endhighlight %}

## Uma visualização que mostre em que ano houve mais evasões

Abaixo temos uma visualização que mostra a quantidade de evasões ao longo dos anos. É possível perceber que 2011 foi o ano em que ocorreu mais evasões, um total de 9. Vale salientar que esse valor pode ser maior nesse ano pela maior quantidade de alunos que se matricularam. Até 2010 a quantidade de matrículas atingiu o valor máximo de 83, a partir de 2011 esse valor passou para 113, chegando a atingir 197 em 2015.


{% highlight r %}
evasoes = subset(dados, EVADIU == T)
contagem.evasoes = group_by(evasoes[!duplicated(evasoes[,1]),], MAT_TUR_ANO) %>% summarise(Evasao = as.numeric(sum(EVADIU == T)))

p = highchart() %>% hc_xAxis(categories = contagem.evasoes$MAT_TUR_ANO) %>% hc_add_series(data = contagem.evasoes$Evasao, name = "Evasões") %>% hc_title(text = "Evasões ao longo dos anos") %>% hc_colors(c("purple")) %>% hc_yAxis(title = list(text = "Total de evasões")) %>% hc_xAxis(title = list(text = "Ano"))
p
{% endhighlight %}

<div class="figure">
<!--html_preserve--><div id="htmlwidget-74edae553617173fd0b9" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-74edae553617173fd0b9">{"x":{"hc_opts":{"title":{"text":"Evasões ao longo dos anos"},"yAxis":{"title":{"text":"Total de evasões"}},"credits":{"enabled":false},"exporting":{"enabled":false},"plotOptions":{"series":{"turboThreshold":0},"treemap":{"layoutAlgorithm":"squarified"},"bubble":{"minSize":5,"maxSize":25}},"annotationsOptions":{"enabledButtons":false},"tooltip":{"delayForDisplay":10},"xAxis":{"categories":[2001,2002,2004,2005,2006,2007,2009,2010,2011,2012,2013,2014,2015],"title":{"text":"Ano"}},"series":[{"data":[3,1,3,4,2,1,4,2,9,7,5,8,4],"name":"Evasões"}],"colors":["purple"]},"theme":{"chart":{"backgroundColor":"transparent"}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->
<p class="caption">plot of chunk unnamed-chunk-2</p>
</div>

## Distribuição das classes

A classe de evasão está distribuída da seguinte maneira ao longo dos anos:


{% highlight r %}
mat_unicas = dados[!duplicated(dados[,1]),]

contagem.distr = group_by(mat_unicas, MAT_TUR_ANO, EVADIU) %>% summarise(count = n())

hchart(contagem.distr, "column", hcaes(x = MAT_TUR_ANO, y = count, group = EVADIU), name= c('Não evadiu', "Evadiu")) %>%  hc_title(text = "Distribuição das classes") %>% hc_colors(c("darkblue", "orange")) %>% hc_yAxis(title = list(text = "Total de alunos")) %>% hc_xAxis(title = list(text = "Ano"))
{% endhighlight %}

<div class="figure">
<!--html_preserve--><div id="htmlwidget-516bf64848a6e7004c61" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-516bf64848a6e7004c61">{"x":{"hc_opts":{"title":{"text":"Distribuição das classes"},"yAxis":{"title":{"text":"Total de alunos"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"plotOptions":{"series":{"turboThreshold":0,"showInLegend":true,"marker":{"enabled":true}},"treemap":{"layoutAlgorithm":"squarified"},"bubble":{"minSize":5,"maxSize":25},"scatter":{"marker":{"symbol":"circle"}}},"annotationsOptions":{"enabledButtons":false},"tooltip":{"delayForDisplay":10},"series":[{"group":false,"data":[{"MAT_TUR_ANO":2000,"EVADIU":false,"count":60,"x":2000,"y":60},{"MAT_TUR_ANO":2001,"EVADIU":false,"count":57,"x":2001,"y":57},{"MAT_TUR_ANO":2002,"EVADIU":false,"count":56,"x":2002,"y":56},{"MAT_TUR_ANO":2003,"EVADIU":false,"count":58,"x":2003,"y":58},{"MAT_TUR_ANO":2004,"EVADIU":false,"count":55,"x":2004,"y":55},{"MAT_TUR_ANO":2005,"EVADIU":false,"count":50,"x":2005,"y":50},{"MAT_TUR_ANO":2006,"EVADIU":false,"count":53,"x":2006,"y":53},{"MAT_TUR_ANO":2007,"EVADIU":false,"count":48,"x":2007,"y":48},{"MAT_TUR_ANO":2008,"EVADIU":false,"count":54,"x":2008,"y":54},{"MAT_TUR_ANO":2009,"EVADIU":false,"count":65,"x":2009,"y":65},{"MAT_TUR_ANO":2010,"EVADIU":false,"count":81,"x":2010,"y":81},{"MAT_TUR_ANO":2011,"EVADIU":false,"count":104,"x":2011,"y":104},{"MAT_TUR_ANO":2012,"EVADIU":false,"count":126,"x":2012,"y":126},{"MAT_TUR_ANO":2013,"EVADIU":false,"count":113,"x":2013,"y":113},{"MAT_TUR_ANO":2014,"EVADIU":false,"count":125,"x":2014,"y":125},{"MAT_TUR_ANO":2015,"EVADIU":false,"count":193,"x":2015,"y":193}],"type":"column","name":"Não evadiu"},{"group":true,"data":[{"MAT_TUR_ANO":2001,"EVADIU":true,"count":3,"x":2001,"y":3},{"MAT_TUR_ANO":2002,"EVADIU":true,"count":1,"x":2002,"y":1},{"MAT_TUR_ANO":2004,"EVADIU":true,"count":3,"x":2004,"y":3},{"MAT_TUR_ANO":2005,"EVADIU":true,"count":4,"x":2005,"y":4},{"MAT_TUR_ANO":2006,"EVADIU":true,"count":2,"x":2006,"y":2},{"MAT_TUR_ANO":2007,"EVADIU":true,"count":1,"x":2007,"y":1},{"MAT_TUR_ANO":2009,"EVADIU":true,"count":4,"x":2009,"y":4},{"MAT_TUR_ANO":2010,"EVADIU":true,"count":2,"x":2010,"y":2},{"MAT_TUR_ANO":2011,"EVADIU":true,"count":9,"x":2011,"y":9},{"MAT_TUR_ANO":2012,"EVADIU":true,"count":7,"x":2012,"y":7},{"MAT_TUR_ANO":2013,"EVADIU":true,"count":5,"x":2013,"y":5},{"MAT_TUR_ANO":2014,"EVADIU":true,"count":8,"x":2014,"y":8},{"MAT_TUR_ANO":2015,"EVADIU":true,"count":4,"x":2015,"y":4}],"type":"column","name":"Evadiu"}],"xAxis":{"type":"linear","title":{"text":"Ano"}},"colors":["darkblue","orange"]},"theme":{"chart":{"backgroundColor":"transparent"}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->
<p class="caption">plot of chunk unnamed-chunk-3</p>
</div>


## Desbalanceamento de classes


{% highlight r %}
 contagem.total = group_by(mat_unicas, EVADIU) %>% summarise(count = n())

hchart(contagem.total, "column", hcaes(y = count, group = EVADIU), name= c('Não evadiu', "Evadiu")) %>%  hc_title(text = "Distribuição da classe") %>% hc_plotOptions(column = list(stacking = "normal")) %>% hc_colors(c("darkblue", "orange")) %>% hc_yAxis(title = list(text = "Total de alunos"))
{% endhighlight %}

<div class="figure">
<!--html_preserve--><div id="htmlwidget-4c13502307d0710e93cc" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-4c13502307d0710e93cc">{"x":{"hc_opts":{"title":{"text":"Distribuição da classe"},"yAxis":{"title":{"text":"Total de alunos"}},"credits":{"enabled":false},"exporting":{"enabled":false},"plotOptions":{"series":{"turboThreshold":0,"showInLegend":true,"marker":{"enabled":true}},"treemap":{"layoutAlgorithm":"squarified"},"bubble":{"minSize":5,"maxSize":25},"scatter":{"marker":{"symbol":"circle"}},"column":{"stacking":"normal"}},"annotationsOptions":{"enabledButtons":false},"tooltip":{"delayForDisplay":10},"series":[{"group":false,"data":[{"EVADIU":false,"count":1298,"y":1298}],"type":"column","name":"Não evadiu"},{"group":true,"data":[{"EVADIU":true,"count":53,"y":53}],"type":"column","name":"Evadiu"}],"xAxis":{"type":null,"title":{"text":[]},"categories":null},"colors":["darkblue","orange"]},"theme":{"chart":{"backgroundColor":"transparent"}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->
<p class="caption">plot of chunk unnamed-chunk-4</p>
</div>

Observando o gráfico acima é possível reparar que a classe relacionada a evasão está desbalanceada, apresentando a seguinte proporção:


{% highlight r %}
contagem.total[2,2]/(contagem.total[1,2] + contagem.total[2,2])
{% endhighlight %}



{% highlight text %}
##       count
## 1 0.0392302
{% endhighlight %}

Uma classe desbalanceada pode influenciar negativamente nos algorítimos de aprendizado uma vez que a parte de maior proporção tende a enviesar o desempenho de classficadores. Tais algorítimos visam minimizar erros gerais, que classes em minoria possuem baixa contribuição. Além disso, os algorítmos assumem que os dados apresentam classes balanceadas assim como que erros são obtidos de diferentes classes.

## Um novo atributo

Adicionamos agora um novo atributo aos dados. O atributo é referente a reprovações nas disciplinas Programação I e Laboratório de Programação I. Entram nessa situação notas nas disciplinas que são abaixo de 5.0. São possíveis os seguintes valores:

* **0**: quando o aluno não reprovou nenhuma da duas disciplinas.
* **1**: quando o aluno reprovou apenas uma das disciplinas.
* **2**: quando o aluno reprovou ambas as disciplinas.

Utilizamos esse atributo por imaginar que alunos que reprovam disciplinas de programação no primeiro semestre são aqueles que não se interessam ou têm dificuldade no conteúdo e tendem a ficar desmotivados com relação ao futuro no curso. Em outras palavras, eles percebem que essa não é a carreira que querem seguir e como consequência evadem.

Abaixo vemos uma repersentação gráfica com o novo atributo:


{% highlight r %}
novo_atr = subset(dados, disciplina == "Programação I" | disciplina == "Laboratório de Programação I") %>% group_by(MAT_ALU_MATRICULA) %>% mutate(rep = sum(MAT_MEDIA_FINAL <5))

mat_unicas = novo_atr[!duplicated(novo_atr[,1]),]
contagem.freq = group_by(mat_unicas, rep,EVADIU) %>% summarise(count = n())

hchart(contagem.freq[contagem.freq$EVADIU==T,], "column", hcaes(x = rep,y=count, group = EVADIU), name= c("Evadiu")) %>%  hc_title(text = "Distribuição evasão") %>% hc_colors(c("darkred")) %>% hc_xAxis(title = list(text = "Número de reprovações em P1 e LP1")) %>% hc_yAxis(title = list(text = "Total de alunos"))
{% endhighlight %}

<div class="figure">
<!--html_preserve--><div id="htmlwidget-33c925ec8e4462388bac" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-33c925ec8e4462388bac">{"x":{"hc_opts":{"title":{"text":"Distribuição evasão"},"yAxis":{"title":{"text":"Total de alunos"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"plotOptions":{"series":{"turboThreshold":0,"showInLegend":true,"marker":{"enabled":true}},"treemap":{"layoutAlgorithm":"squarified"},"bubble":{"minSize":5,"maxSize":25},"scatter":{"marker":{"symbol":"circle"}}},"annotationsOptions":{"enabledButtons":false},"tooltip":{"delayForDisplay":10},"series":[{"group":true,"data":[{"rep":0,"EVADIU":true,"count":17,"x":0,"y":17},{"rep":2,"EVADIU":true,"count":24,"x":2,"y":24},{"rep":null,"EVADIU":true,"count":12,"x":null,"y":12}],"type":"column","name":"Evadiu"}],"xAxis":{"type":"linear","title":{"text":"Número de reprovações em P1 e LP1"}},"colors":["darkred"]},"theme":{"chart":{"backgroundColor":"transparent"}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->
<p class="caption">plot of chunk unnamed-chunk-6</p>
</div>

{% highlight r %}
hchart(contagem.freq[contagem.freq$EVADIU==F,], "column", hcaes(x = rep,y=count, group = EVADIU), name= c("Não evadiu")) %>%  hc_title(text = "Distribuição não-evasão") %>% hc_colors(c("darkred")) %>% hc_xAxis(title = list(text = "Número de reprovações em P1 e LP1")) %>% hc_yAxis(title = list(text = "Total de alunos"))
{% endhighlight %}

<div class="figure">
<!--html_preserve--><div id="htmlwidget-e3845760a60b37c424dd" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-e3845760a60b37c424dd">{"x":{"hc_opts":{"title":{"text":"Distribuição não-evasão"},"yAxis":{"title":{"text":"Total de alunos"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"plotOptions":{"series":{"turboThreshold":0,"showInLegend":true,"marker":{"enabled":true}},"treemap":{"layoutAlgorithm":"squarified"},"bubble":{"minSize":5,"maxSize":25},"scatter":{"marker":{"symbol":"circle"}}},"annotationsOptions":{"enabledButtons":false},"tooltip":{"delayForDisplay":10},"series":[{"group":false,"data":[{"rep":0,"EVADIU":false,"count":1013,"x":0,"y":1013},{"rep":1,"EVADIU":false,"count":23,"x":1,"y":23},{"rep":2,"EVADIU":false,"count":166,"x":2,"y":166},{"rep":null,"EVADIU":false,"count":94,"x":null,"y":94}],"type":"column","name":"Não evadiu"}],"xAxis":{"type":"linear","title":{"text":"Número de reprovações em P1 e LP1"}},"colors":["darkred"]},"theme":{"chart":{"backgroundColor":"transparent"}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->
<p class="caption">plot of chunk unnamed-chunk-6</p>
</div>

Percebemos que os alunos que evadiram se concentram no grupo dos que reprovaram ambas as disciplinas, reparamos também que dos alunos que evadiram nenhum reprovou apenas uma das disciplinas. Também é possível notar que o número de alunos que **não** evadiram é consideravelmente maior no cenário em que não há reprovações.
 
Os gráficos nos mostram que a maior frequência de evasão e não-evasão ocorrem em grupos diferentes. As distribuições dos atributos tem valores diferentes entre as classes e isso ajuda mais o classificador, pois os valores podem ser separados mais facilmente, reduzindo a probabilidade de erros no momento de predição da classe.
